plugins {
    id 'org.jetbrains.kotlin.jvm' version '1.3.72'
}

group 'de.akquinet'
version '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}

task computeAverageIncomeKotlin(type: JavaExec) {
    classpath sourceSets.main.runtimeClasspath
    main = "ComputeAverageIncomeKt"
}

// Stack must be installed and the executable must be in the path
// https://docs.haskellstack.org/en/stable/README/
task computeAverageIncomeHaskell(type: Exec) {
    workingDir "./src/main/Haskell/compute-average-income"
    commandLine "stack", "run"
}

// Rust must be installed using rustup
// https://www.rust-lang.org
task computeAverageIncomeRust(type: Exec) {
    workingDir "./src/main/Rust/compute_average_income"
    commandLine "cargo", "run", "--release", "--package", "compute_average_income",  "--bin", "compute_average_income"
}

task computeAverageIncome {
    dependsOn "computeAverageIncomeRust"
    dependsOn "computeAverageIncomeHaskell"
    dependsOn "computeAverageIncomeKotlin"
}
